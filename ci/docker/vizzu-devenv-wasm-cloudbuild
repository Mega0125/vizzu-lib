# container for cloudbuild, use with ci/cloudbuild/wasm-docker-build.yaml

FROM ubuntu:focal


RUN apt-get update; \
    echo 'debconf debconf/frontend select Noninteractive' | debconf-set-selections && apt-get install -y -q; \
    apt-get install -y apt-utils dialog software-properties-common wget

RUN wget -O - https://vizzuhq.github.io/ppa/ubuntu/KEY.gpg | apt-key add -; \
    add-apt-repository "deb https://vizzuhq.github.io/ppa/ubuntu ./"; \
    apt-get install -y vizzu-devenv

COPY . /workspace

RUN mkdir -p /workspace/build/cmake-wasm
WORKDIR /workspace/build/cmake-wasm
RUN /root/emsdk/upstream/emscripten/emcmake cmake ../../project/cmake/
RUN make

