steps:
- name: 'vizzu/vizzu-devenv'
  args: [ 'mkdir', '-p', '/workspace/build/cmake-desktop' ]
  waitFor: ['-']
  id: 'create_build_folder-desktop'
- name: 'vizzu/vizzu-devenv'
  args: [ 'cmake', '../../project/cmake/' ]
  dir: '/workspace/build/cmake-desktop'
  waitFor: ['create_build_folder-desktop']
  id: 'cmake-desktop'
- name: 'vizzu/vizzu-devenv'
  args: [ 'make' ]
  dir: '/workspace/build/cmake-desktop'
  timeout: 1800s
  waitFor: ['cmake-desktop']
  id: 'make-desktop'
- name: 'vizzu/vizzu-devenv'
  args: [ './vizzutest' ]
  dir: '/workspace/build/cmake-desktop/test'
  waitFor: ['make-desktop']
  id: 'test-desktop'
- name: 'vizzu/vizzu-devenv'
  args: [ 'mkdir', '-p', '/workspace/build/cmake-wasm' ]
  waitFor: ['-']
  id: 'create_build_folder-wasm'
- name: 'vizzu/vizzu-devenv'
  args: [ '/root/emsdk/upstream/emscripten/emcmake', 'cmake', '../../project/cmake/' ]
  dir: '/workspace/build/cmake-wasm'
  waitFor: ['create_build_folder-wasm']
  id: 'cmake-wasm'
- name: 'vizzu/vizzu-devenv'
  args: [ 'make' ]
  dir: '/workspace/build/cmake-wasm'
  timeout: 1800s
  waitFor: ['cmake-wasm']
  id: 'make-wasm'
- name: 'vizzu/vizzu-devenv'
  args: [ 'node', 'vizzutest.js' ]
  dir: '/workspace/build/cmake-wasm/test'
  waitFor: ['make-wasm']
  id: 'test-wasm'
timeout: 1800s
options:
 machineType: 'E2_HIGHCPU_8'
artifacts:
  objects:
    location: 'gs://vizzu-lib-main'
    paths:
      - /workspace/example/lib/*
